最好先关闭合成器

[mesa-turnip-kgsl-24.1.0-devel](https://github.com/LinuxDroidMaster/Termux-Desktops/blob/main/Documentation/HardwareAcceleration.md) 的驱动

```bash
sudo rm -f /usr/lib/libvulkan_freedreno.so /usr/share/vulkan/icd.d/freedreno_icd.aarch64.json && sudo pacman -S --noconfirm --needed unzip mesa vulkan-icd-loader vulkan-headers && wget https://github.com/MatrixhKa/mesa-turnip/releases/download/24.1.0/mesa-turnip-kgsl-24.1.0-devel.zip && unzip mesa-* -d turnip/ && cd turnip/ && sudo mkdir -p /usr/share/vulkan/icd.d/ && sudo mv libvulkan_freedreno.so /usr/lib/ && sudo mv freedreno_icd.aarch64.json /usr/share/vulkan/icd.d/ && cd .. && rm -r turnip/ mesa-turnip-kgsl-24.1.0-devel.zip
```

[mesa-vulkan-kgsl_24.1.0-devel-20240324_arm64.deb](https://www.bilibili.com/opus/1042342069764358179) 的驱动，确保 mesa-vulkan-kgsl_24.1.0-devel-20240324_arm64.deb 已经位于主目录

```bash
sudo rm -f /usr/lib/libvulkan_freedreno.so /usr/share/vulkan/icd.d/freedreno_icd.aarch64.json && sudo pacman -S --noconfirm --needed mesa vulkan-icd-loader vulkan-headers && mkdir -p ~/turnip_temp && cp ~/mesa-vulkan-kgsl_24.1.0-devel-20240324_arm64.deb ~/turnip_temp/ && cd ~/turnip_temp && ar x mesa-vulkan-kgsl_24.1.0-devel-20240324_arm64.deb && tar -xf data.tar.zst && sudo mv usr/lib/aarch64-linux-gnu/libvulkan_freedreno.so /usr/lib/ && sudo mv usr/share/vulkan/icd.d/freedreno_icd.aarch64.json /usr/share/vulkan/icd.d/ && cd ~ && rm -rf ~/turnip_temp && sudo sed -i 's|/usr/lib/aarch64-linux-gnu/|/usr/lib/|g' /usr/share/vulkan/icd.d/freedreno_icd.aarch64.json && rm ~/mesa-vulkan-kgsl_24.1.0-devel-20240324_arm64.deb
```

如果黑屏，卸载 vulkan-icd-loader

```bash
sudo pacman -Rdd vulkan-icd-loader
```

关闭合成器后重新安装 vulkan-icd-loader

```bash
sudo pacman -S vulkan-icd-loader
```

**启动脚本更改**

将行

```bash
dbus-run-session startxfce4
```

改为

```bash
dbus-launch --exit-with-session && TU_DEBUG=noconform ZINK_DESCRIPTORS=lazy ZINK_DEBUG=compact startxfce4
```

**验证**

```bash
sudo pacman -S --noconfirm --needed mesa-utils
glxinfo | grep "OpenGL renderer"
glxgears

# 可选的
sudo pacman -S --noconfirm --needed vulkan-tools
vkcube # 由于兼容性问题，vkcube 可能不工作
```