### 备份恢复 arch

也可以使用脚本

![[backup-arch.sh]]

![[restore-arch.sh]]

```bash
# 备份
cd /data/local/tmp/
tar -I zstd -cpf arch-backup-$(date +%Y%m%d).tar.zst arch/

# 还原
tar -I zstd -xpf arch-backup-yyyymmdd.tar.zst
```

如果有套接字(140000)的提示，可以忽略

### xfce4

设置缩放: ==外观== 里面设置窗口缩放倍数为 2x，不要到 ==显示== 中调整

对于 Qt 应用

```bash
echo 'export QT_SCALE_FACTOR=2' | sudo tee /etc/profile.d/qt-scaling.sh
```

对于 lapce

```bash
echo 'export WINIT_X11_SCALE_FACTOR=2' | sudo tee /etc/profile.d/winntx11-scaling.sh
```
让窗口边框也可以缩放 & 推荐主题

```bash
paru -S yaru-xfwm4-theme yaru-gtk-theme yaru-icon-theme
```

重置面板

```bash
mv ~/.config/xfce4/xfconf/xfce-perchannel-xml/xfce4-panel.xml ~/.config/xfce4/xfconf/xfce-perchannel-xml/xfce4-panel.xml.bak
```

没有回收站

```bash
sudo pacman -S gvfs
```

没有下载、文档等文件夹

```bash
sudo pacman -S xdg-user-dirs
LANG=en_US.UTF-8 xdg-user-dirs-update
```

### TurnipXfce4启动桌面脚本

```
#!/bin/sh

killall -9 termux-x11 Xwayland pulseaudio virgl_test_server_android 2>/dev/null

termux-x11 :0 -dpi 96 &
am start --user 0 -n com.termux.x11/com.termux.x11.MainActivity

virgl_test_server_android &

su -c sh <<'EOF'

# Linux 文件系统路径
ChrootPath="/data/local/tmp/arch"

# 解决用户切换的 setuid 问题
busybox mount -o remount,dev,suid /data

# 确保目录存在
mkdir -p $ChrootPath/dev/pts
mkdir -p $ChrootPath/dev/shm
mkdir -p $ChrootPath/proc
mkdir -p $ChrootPath/sys
mkdir -p $ChrootPath/tmp
mkdir -p $ChrootPath/sdcard

# 挂载核心系统目录
busybox mount --bind /dev $ChrootPath/dev
busybox mount --bind /sys $ChrootPath/sys
busybox mount --bind /proc $ChrootPath/proc
busybox mount -t devpts devpts $ChrootPath/dev/pts
busybox mount -t tmpfs -o size=512M tmpfs $ChrootPath/dev/shm

# 挂载内部存储空间
busybox mount --bind /sdcard $ChrootPath/sdcard

# 挂载 Termux 的 tmp 目录，用于 X11 通信
busybox mount --bind /data/data/com.termux/files/usr/tmp $ChrootPath/tmp

# 等 X11 socket 就绪（避免 race）
while [ ! -S "/data/data/com.termux/files/usr/tmp/.X11-unix/X0" ]; do sleep 0.2; done

# Chroot 并进入桌面（硬件加速）
# busybox chroot $ChrootPath /bin/su - yumeka -c 'export XDG_RUNTIME_DIR=/tmp/xdg-yumeka && mkdir -p $XDG_RUNTIME_DIR && chmod 0700 $XDG_RUNTIME_DIR && export DISPLAY=:0 PULSE_SERVER=tcp:127.0.0.1:4713 && TU_DEBUG=noconform ZINK_DESCRIPTORS=lazy ZINK_DEBUG=compact /usr/bin/dbus-run-session startxfce4'

# 让 Mesa 直接走 VirGL
busybox chroot $ChrootPath /bin/su - yumeka -c '
export XDG_RUNTIME_DIR=/tmp/xdg-yumeka && mkdir -p $XDG_RUNTIME_DIR && chmod 0700 $XDG_RUNTIME_DIR
export DISPLAY=:0 PULSE_SERVER=tcp:127.0.0.1:4713
export GALLIUM_DRIVER=virpipe
export LIBGL_DRI3_ENABLE=1
export VIRGL_SERVER_SOCKET=/data/data/com.termux/files/usr/tmp/.virgl
dbus-run-session startxfce4
'

# Chroot 并进入桌面（无硬件加速）
# busybox chroot $ChrootPath /bin/su - yumeka -c 'export XDG_RUNTIME_DIR=/tmp/xdg-yumeka && mkdir -p $XDG_RUNTIME_DIR && chmod 0700 $XDG_RUNTIME_DIR && export DISPLAY=:0 PULSE_SERVER=tcp:127.0.0.1:4713 && /usr/bin/dbus-run-session startxfce4'

EOF
```

### VSCode 无法启动

你应该替换为正确的目录

```bash
sudo chmod 4755 /opt/visual-studio-code/chrome-sandbox
```

```bash
sudo chown root:root /opt/visual-studio-code/chrome-sandbox
```

或者

```bash
sudo mkdir -p /dev/shm
```

### 使其 jetbrains 在 fish 中破解补丁生效

> 编辑 ~/.config/fish/config.fish
> ```bash
> source ~/.jetbrains.vmoptions.sh
> ```